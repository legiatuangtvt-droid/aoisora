<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="logo.png" type="image/png">
    <title>Đăng Ký Giờ Làm - AoiSora</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="output.css">
    <style>
        table {
            border-collapse: collapse;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>

</head>
<body class="flex h-screen text-gray-800">

    <!-- Sidebar Placeholder -->
    <div id="sidebar-placeholder"></div>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col overflow-hidden">
        <!-- Header Placeholder -->
        <div id="header-placeholder"></div>

        <!-- Content Area -->
        <main class="flex-1 overflow-auto p-6 lg:p-8 bg-white relative">
            <!-- View Toggler -->
            <div class="absolute top-4 right-4 z-30">
                <button id="view-toggle-btn" class="btn btn-secondary btn-sm">
                    <i class="fas fa-mobile-alt mr-2"></i>
                    <span>Mobile View</span>
                </button>
            </div>

            <!-- Desktop View -->
            <div id="desktop-view">
                <div class="mx-auto">
                    <!-- Dòng 1: Điều hướng ngày -->
                    <div class="text-center my-4">
                        <h2 id="current-date-display" class="text-xl font-bold text-gray-800">Đang tải...</h2>
                        <p class="text-sm text-gray-500">Chu kỳ đăng ký</p>
                    </div>

                    <!-- Bảng đăng ký -->
                    <div class="bg-white p-4 rounded-lg shadow-md border border-gray-200">
                        <div>
                            <table class="min-w-full border-collapse">
                                <!-- JavaScript sẽ render các dòng header và dòng đăng ký vào đây -->
                                <tbody id="availability-table-body">
                                    <!-- Ví dụ: JS sẽ tạo ra các cặp <tr>...</tr> cho mỗi tuần -->
                                </tbody>
                            </table>
                        </div>

                        <!-- Ghi chú -->
                        <div class="mt-4 p-4 bg-gray-50 rounded-lg flex items-center justify-center gap-8 text-sm text-gray-600">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-circle text-green-500"></i>
                                <span>: Chắc chắn vào ca (Ưu tiên 1)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-triangle-exclamation text-amber-500"></i>
                                <span>: Có thể vào ca (Ưu tiên 2)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Nút lưu -->
                    <div class="mt-6 flex justify-end">
                        <button id="save-week-availability-btn" class="btn btn-indigo">
                            <i class="fas fa-save mr-2"></i>
                            Đăng Ký
                        </button>
                    </div>
                    <!-- Template cho các ô trong bảng -->
                    <template id="day-header-template">
                        <th class="p-2 border-l border-gray-200 first:border-l-0 align-top">
                            <div class="flex justify-center items-start relative">
                                <div class="text-center">
                                    <div class="day-name font-semibold text-gray-700"></div>
                                    <div class="date-number text-xs text-gray-500"></div>
                                </div>
                                <button class="help-btn absolute top-0 right-0 text-slate-400 hover:text-indigo-600 transition-colors" title="Đăng ký giờ hỗ trợ"><i class="fas fa-hands-helping"></i></button>
                            </div>
                        </th>
                    </template>
                
                    <template id="shift-cell-template">
                        <td class="p-2 border-l border-gray-200 align-top first:border-l-0">
                            <div class="flex flex-col h-full">
                                <div class="flex items-start gap-1 flex-grow">
                                <!-- Ca 1 -->
                                <div class="shift-registration-block flex-1" data-shift-index="0">
                                    <div class="flex-grow">
                                        <select class="shift-input text-center form-select form-select-sm w-full"></select>
                                    </div>
                                    <button class="priority-toggle-btn mt-2 w-full h-8 flex items-center justify-center rounded disabled:opacity-50 disabled:cursor-not-allowed" data-priority="1" title="Chắc chắn vào ca" disabled><i class="fas fa-circle text-gray-300 text-lg"></i></button>

                                </div>
                                <!-- Ca 2 -->
                                <div class="shift-registration-block flex-1" data-shift-index="1">
                                    <div class="flex-grow">
                                        <select class="shift-input text-center form-select form-select-sm w-full"></select>
                                    </div>
                                    <button class="priority-toggle-btn mt-2 w-full h-8 flex items-center justify-center rounded disabled:opacity-50 disabled:cursor-not-allowed" data-priority="1" title="Có thể vào ca" disabled><i class="fas fa-circle text-gray-300 text-lg"></i></button>
                                </div>
                                </div>
                            </div>
                        </td>
                    </template>
                </div>
            </div>

            <!-- Mobile View -->
            <div id="mobile-view" class="hidden">
                <div class="mobile-header">
                    <h2 id="mobile-month-header">November 2025</h2>
                </div>
                <!-- Container cho toàn bộ nội dung có thể cuộn -->
                <div class="flex-grow overflow-y-auto">
                    <!-- Lịch tháng -->
                    <div class="mobile-main-content">
                        <div id="mobile-calendar-header-grid" class="mobile-calendar-header-grid"></div>
                        <div id="mobile-calendar-body-grid" class="mobile-calendar-body-grid"></div>
                    </div>
                    <!-- Các khối thông tin độc lập -->
                    <div class="mobile-totals p-2 border-b border-slate-200">
                        <span class="font-semibold ml-2">Total</span>
                        <span id="mobile-total-pay" class="font-bold text-lg mr-2">...</span>
                    </div>
                    <section class="mobile-shift-legend border-b mb-2 border-gray-200">
                        <div id="mobile-shift-legend-body" class="grid grid-cols-2 gap-x-4 gap-y-1 text-sm mr-3 ml-3 mt-2"></div>
                    </section>
                </div>
                <section class="mobile-daily-detail">
                    <h4 id="mobile-selected-date" class="font-bold text-sm">Select a date</h4>
                    <input type="text" placeholder="Memo ..." class="form-input w-full mt-2 text-sm">
                    <button class="btn btn-indigo w-full mt-2">
                        <i class="fas fa-plus mr-2"></i> Add Shift
                    </button>
                </section>
            </div>
        </main>
    </div>

    <!-- MODAL: Chọn giờ Help -->
    <div id="help-modal" class="modal-overlay hidden">
        <div class="modal-content max-w-sm">
            <div class="modal-header">
                <h3 id="help-modal-title" class="modal-title">Đăng ký giờ hỗ trợ</h3>
                <button type="button" class="modal-close-btn" data-modal-id="help-modal">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="help-modal-date">
                <div class="grid grid-cols-2 gap-4">
                    <div class="form-group">
                        <label for="help-start-time" class="form-label">Giờ bắt đầu</label>
                        <input type="time" id="help-start-time" class="form-input" step="1800">
                    </div>
                    <div class="form-group">
                        <label for="help-end-time" class="form-label">Giờ kết thúc</label>
                        <input type="time" id="help-end-time" class="form-input" step="1800">
                    </div>
                </div>
            </div>
            <div class="modal-footer"><button type="button" class="btn-secondary modal-close-btn" data-modal-id="help-modal">Hủy</button><button type="button" id="save-help-time-btn" class="btn btn-indigo">Lưu</button></div>
        </div>
    </div>
    
    <script type="module" src="bootstrapper.js" defer></script>
</body>
</html>